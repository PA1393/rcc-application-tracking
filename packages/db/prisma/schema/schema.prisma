generator client {
  provider = "prisma-client-js"
  output   = "../generated"
  moduleFormat = "esm"
}

datasource db {
  provider = "postgresql"
}

model Applicant{

  id                      String @id  @default(uuid())
  name                    String
  preferred_email         String?
  email                   String @unique  //make sure two people do no have same email
  notes                   String? //conflicts, preferences, follow-ups

  applications Application[]    //array applications belongs to single applicant bc --> one applicant can have many applications
  placements   Placement[]      //one application can have many placemeents OVERTIME

}

model Application{

  id                      String @id  @default(uuid())
  applicant_id            String  //(This links back to Table 1)
  applicant               Applicant  @relation(fields: [applicant_id], references: [id], onDelete: Cascade)

  role                    String
  track                   String 
  status                  String  //Applied / Interviewing / Accepted / Rejected / Waitlisted / Closed
  season                  String

  interview_notes         String? @db.Text 

  rawData                 Json?  //stores the raw responses

  interview_invite_sent   DateTime? 
  acceptance_sent_at      DateTime? 
  rejection_sent_at       DateTime? 
  applied_at              DateTime  @default(now())

   


  @@unique([applicant_id, role, season]) //same applicant canâ€™t have duplicate application rows for the same role in the same season.
  @@index([season]) //helps with queries
  @@index([status]) //queries


}

model Placement{

  id                      String @id  @default(uuid())
  applicant_id            String  //(This links back to Table 1)
  applicant               Applicant  @relation(fields: [applicant_id], references: [id], onDelete: Cascade)

  track                   String 
  role                    String //the role they won
  placed_at DateTime @default(now())

  season                  String //This is what lets the "Keycard" expire so they can apply again next year.


  @@unique([applicant_id, track, season])


}

